# ã‚°ãƒ«ãƒ¼ãƒ—ã”ã¨ã®ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹æ©Ÿèƒ½ãƒ†ã‚¹ãƒˆæ‰‹é †

## âœ… ãƒã‚¤ã‚°ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³å®Œäº†å¾Œã®ç¢ºèª

### 1. ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã‚’å†èµ·å‹•
```bash
npm run dev
```

### 2. ãƒ†ã‚¹ãƒˆã‚·ãƒŠãƒªã‚ª

#### ã‚·ãƒŠãƒªã‚ªA: è¤‡æ•°ã‚°ãƒ«ãƒ¼ãƒ—ã§ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ãŒç‹¬ç«‹ã—ã¦ã„ã‚‹ã‹ç¢ºèª

1. **ã‚°ãƒ«ãƒ¼ãƒ—1ã«å‚åŠ **
   - ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ã‚’ã€Œå–è¾¼ä¸­ã€ã«å¤‰æ›´
   - ã‚«ã‚¹ã‚¿ãƒ 1ã‚’ã€Œå‹‰å¼·ä¸­ã€ã«è¨­å®š

2. **ã‚°ãƒ«ãƒ¼ãƒ—2ã«åˆ‡ã‚Šæ›¿ãˆ**
   - ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ãŒã€Œè©±ã—ã‹ã‘ã¦OKã€ï¼ˆãƒ‡ãƒ•ã‚©ãƒ«ãƒˆï¼‰ã«ãªã£ã¦ã„ã‚‹ã‹ç¢ºèª
   - ã‚«ã‚¹ã‚¿ãƒ 1ãŒã€Œã‚«ã‚¹ã‚¿ãƒ 1ã€ï¼ˆãƒ‡ãƒ•ã‚©ãƒ«ãƒˆï¼‰ã«ãªã£ã¦ã„ã‚‹ã‹ç¢ºèª
   - ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ã‚’ã€Œå®šæ™‚ã§å¸°ã‚ŠãŸã„ã€ã«å¤‰æ›´

3. **ã‚°ãƒ«ãƒ¼ãƒ—1ã«æˆ»ã‚‹**
   - ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ãŒã€Œå–è¾¼ä¸­ã€ã®ã¾ã¾ã‹ç¢ºèª
   - ã‚«ã‚¹ã‚¿ãƒ 1ãŒã€Œå‹‰å¼·ä¸­ã€ã®ã¾ã¾ã‹ç¢ºèª

#### ã‚·ãƒŠãƒªã‚ªB: æ–°ã—ã„ã‚°ãƒ«ãƒ¼ãƒ—ã‚’ä½œæˆã—ãŸæ™‚

1. **æ–°ã—ã„ã‚°ãƒ«ãƒ¼ãƒ—ã‚’ä½œæˆ**
   - ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ã€Œè©±ã—ã‹ã‘ã¦OKã€ã«ãªã£ã¦ã„ã‚‹ã‹ç¢ºèª
   - ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã‚«ã‚¹ã‚¿ãƒ ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ã«ãªã£ã¦ã„ã‚‹ã‹ç¢ºèª

### 3. æœŸå¾…ã•ã‚Œã‚‹å‹•ä½œ

âœ… **ã‚°ãƒ«ãƒ¼ãƒ—ã”ã¨ã«ç‹¬ç«‹ã—ãŸã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹**
- ã‚°ãƒ«ãƒ¼ãƒ—Aã§ã€Œå–è¾¼ä¸­ã€
- ã‚°ãƒ«ãƒ¼ãƒ—Bã§ã€Œå®šæ™‚ã§å¸°ã‚ŠãŸã„ã€
- ã‚°ãƒ«ãƒ¼ãƒ—Aã«æˆ»ã‚‹ã¨ã€Œå–è¾¼ä¸­ã€ã®ã¾ã¾

âœ… **ã‚«ã‚¹ã‚¿ãƒ ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ã‚‚ã‚°ãƒ«ãƒ¼ãƒ—ã”ã¨**
- ã‚°ãƒ«ãƒ¼ãƒ—Aã®ã‚«ã‚¹ã‚¿ãƒ 1: ã€Œå‹‰å¼·ä¸­ã€
- ã‚°ãƒ«ãƒ¼ãƒ—Bã®ã‚«ã‚¹ã‚¿ãƒ 1: ã€Œä¼šè­°ä¸­ã€
- ãã‚Œãã‚Œç‹¬ç«‹ã—ã¦ä¿å­˜ã•ã‚Œã‚‹

### 4. ãƒˆãƒ©ãƒ–ãƒ«ã‚·ãƒ¥ãƒ¼ãƒ†ã‚£ãƒ³ã‚°

#### ã‚¨ãƒ©ãƒ¼: `column "organization_id" cannot be null`
â†’ ãƒã‚¤ã‚°ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ã®ã‚¹ãƒ†ãƒƒãƒ—5ãŒæ­£ã—ãå®Ÿè¡Œã•ã‚Œã¦ã„ãªã„å¯èƒ½æ€§ãŒã‚ã‚Šã¾ã™

```sql
-- æ—¢å­˜ãƒ‡ãƒ¼ã‚¿ã®ç¢ºèª
SELECT * FROM user_status WHERE organization_id IS NULL;

-- æ‰‹å‹•ã§ä¿®æ­£
UPDATE user_status us
SET organization_id = (
  SELECT organization_id 
  FROM user_organizations uo 
  WHERE uo.user_id = us.user_id 
    AND uo.is_active = true 
  LIMIT 1
)
WHERE organization_id IS NULL;
```

#### ã‚¨ãƒ©ãƒ¼: `duplicate key value violates unique constraint`
â†’ æ—¢å­˜ãƒ‡ãƒ¼ã‚¿ã«é‡è¤‡ãŒã‚ã‚‹å¯èƒ½æ€§ãŒã‚ã‚Šã¾ã™

```sql
-- é‡è¤‡ãƒ‡ãƒ¼ã‚¿ã®ç¢ºèª
SELECT user_id, organization_id, COUNT(*) 
FROM user_status 
GROUP BY user_id, organization_id 
HAVING COUNT(*) > 1;

-- å¤ã„ãƒ¬ã‚³ãƒ¼ãƒ‰ã‚’å‰Šé™¤ï¼ˆupdated_atãŒå¤ã„æ–¹ï¼‰
DELETE FROM user_status a
USING user_status b
WHERE a.user_id = b.user_id 
  AND a.organization_id = b.organization_id
  AND a.updated_at < b.updated_at;
```

## ğŸ” ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ç¢ºèªã‚¯ã‚¨ãƒª

```sql
-- ãƒ¦ãƒ¼ã‚¶ãƒ¼ã®ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ä¸€è¦§ã‚’ç¢ºèª
SELECT 
  u.name AS user_name,
  o.name AS org_name,
  us.status,
  us.custom1_label,
  us.custom2_label,
  us.updated_at
FROM user_status us
JOIN users u ON us.user_id = u.id
JOIN organizations o ON us.organization_id = o.id
ORDER BY u.name, o.name;
```

```sql
-- ãƒ†ãƒ¼ãƒ–ãƒ«æ§‹é€ ã‚’ç¢ºèª
SELECT 
  column_name, 
  data_type, 
  is_nullable,
  column_default
FROM information_schema.columns
WHERE table_name = 'user_status';
```

```sql
-- åˆ¶ç´„ã‚’ç¢ºèª
SELECT conname, contype 
FROM pg_constraint 
WHERE conrelid = 'user_status'::regclass;
```

